<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mechanoreceptor Test Page</title>
</head>

<body>
    <h1>Mechanoreceptor Test Page</h1>
    <script type="module">
        console.log('Script started');
        import * as Mechanoreceptor from './src/index.ts'
        window.Mechanoreceptor = Mechanoreceptor;

        console.log('Initializing Mechanoreceptor components');
        const keyboardSource = new Mechanoreceptor.KeyboardSource();
        const mouseSource = new Mechanoreceptor.MouseSource();
        const gamepadSource = new Mechanoreceptor.GamepadSource();
        const touchSource = new Mechanoreceptor.TouchSource();
        const mappingManager = new Mechanoreceptor.MappingConfigManager();

        keyboardSource.initialize();
        mouseSource.initialize();
        gamepadSource.initialize();
        touchSource.initialize();
        console.log('Mechanoreceptor components initialized');

        window.lastKeyPressed = null;
        window.lastMouseClick = null;

        keyboardSource.onKeyDown = (event) => {
            window.lastKeyPressed = event.code;
            console.log('Key pressed:', event.code);
        };

        mouseSource.onMouseDown = (event) => {
            window.lastMouseClick = { x: event.clientX, y: event.clientY };
            console.log('Mouse clicked:', event.clientX, event.clientY);
        };

        function update() {
            keyboardSource.update();
            mouseSource.update();
            gamepadSource.update();
            touchSource.update();
            requestAnimationFrame(update);
        }

        update();

        // Expose components for testing
        window.keyboardSource = keyboardSource;
        window.mouseSource = mouseSource;
        window.gamepadSource = gamepadSource;
        window.touchSource = touchSource;
        window.mappingManager = mappingManager;

        // Signal that Mechanoreceptor is ready
        window.mechanoreceptorReady = true;
        console.log('Mechanoreceptor is ready');
    </script>
</body>

</html>
